<div class="ui column doubling grid main-container">
    <div class="row container buy-container">
        <div class="column">
            <form class="ui inverted form" [formGroup]="saleForm" name="Form">
                <div class="ui four column doubling grid">            
                    <div class="row">
                        <div class="column formItem">
                            <sm-select 
                                class="fluid inverted search"                            
                                label="Producto" 
                                [control]="saleForm.controls.product" 
                                placeholder="Ingresar Producto">
                                <option *ngFor="let product of productsToChoose">{{product.name}}</option>                                
                            </sm-select>
                        </div>
                        <div class="column formItem">
                            <sm-select 
                                class="provider-select fluid search inverted"                                                        
                                label="Proveedor (el primer valor es recomendado)" 
                                [control]="saleForm.controls.provider_id" 
                                placeholder="Ingresar Proveedor">
                                <option *ngFor="let provider of filteredProviders" value="{{provider.id}}">{{provider.name}}</option>
                            </sm-select>
                        </div>
                        <div class="column formItem">
                            <sm-select 
                                class="fluid inverted"                            
                                label="Tipo de Compra" 
                                [control]="saleForm.controls.typeOfBuy" 
                                placeholder="Ingresar tipo de compra">
                                <option>Cuenta corriente</option>
                                <option>Efectivo</option>
                            </sm-select>
                        </div>
                        <div class="column formItem">
                            <sm-input 
                                icon="shopping bag"
                                type="number" 
                                label="Cantidad" 
                                [control]="saleForm.controls.quantity" 
                                placeholder="Ingresar Cantidad">
                            </sm-input>
                        </div>
                        <div class="two wide two height left floated column formItem addProduct">
                            <sm-button class="normal tiny" [disabled]="saleForm.invalid" (click)="addProduct()">Agregar producto</sm-button>                            
                        </div>
                    </div>
                </div>
            </form>
            <p>
                "La eleccion de Proveedor y Tipo de Compra reemplazara los anteriormente seleccionados en la orden de compra"
            </p>
        </div>
    </div>
    <div class="row container buy-container">
        <div class="column">
            <h1>Busqueda de productos</h1>
            <table-pagination [productList]="stock?.products"></table-pagination>
        </div>
    </div>
    <div class="row container buy-container">
        <div class="column">
            <h1>Orden de compras</h1>                
            <table class="ui celled table">
                <thead>
                    <tr>
                        <th>Nombre de producto</th>
                        <th>Proveedor</th>
                        <th>Forma de pago</th>
                        <th>Cantidad</th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngIf="selectedProducts.length > 0; else noProductsSelectedTemplate">
                        <tr *ngFor="let selected of selectedProducts">
                            <td>{{selected.product.name}}</td>
                            <td>{{selectedProvider.name}}</td>                            
                            <td>{{saleForm.controls.typeOfBuy.value}}</td>                            
                            <td>{{selected.quantity}}</td>                           
                        </tr>
                    </ng-container>
                    <ng-template #noProductsSelectedTemplate>
                        <tr>
                            <td colspan="5"><h3>No hay productos seleccionados</h3></td>                       
                        </tr>
                    </ng-template>
                    
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="column">
            <span class="total">Total:</span>
            <span class="total">${{total | number: '1.2-5'}}</span>                                                       
        </div>
    </div>

    <div class="row">
        <div class="column">
            <sm-button class="normal tiny" [disabled]="selectedProducts.length === 0" (click)="buy()">Comprar productos</sm-button>
        </div>
    </div>
</div>